require 'rho/rhoapplication'

class AppApplication < Rho::RhoApplication
  def initialize
    if Category.find(:all).size == 0 || Map.find(:all).size == 0
      Rhom::Rhom.database_full_reset(false, true)
      # PLACEHOLDER: categories & maps, i.e. categories.each{|category| Category.create(category) }
      [{'sign'=>"ancient",'name_ua'=>"Стародавня історія України",'name_ru'=>"Древняя история Украины"},{'sign'=>"emergence",'name_ua'=>"Виникнення та розквіт Київської Русі",'name_ru'=>"Возникновение и расцвет Киевской Руси"},{'sign'=>"fragmentation",'name_ua'=>"Київська Русь за часів роздробленості. Галицько-Волинська держава — правонаступниця Київської держави",'name_ru'=>"Киевская Русь во времена раздробленности. Галицко-Волынское государство - правопреемник Киевского государства"},{'sign'=>"structure",'name_ua'=>"Політичний устрій, соціально-економічний і культурний розвиток Київської Русі та Галицько-Волинської держави",'name_ru'=>"Политическое устройство, социально-экономическое и культурное развитие Киевской Руси и Галицко-Волынского государства"},{'sign'=>"litva",'name_ua'=>"Українські землі у складі Великого князівства Литовського та інших держав (у другій половині XIV - першій половині XVI ст.",'name_ru'=>"Украинские земли в составе Великого княжества Литовского и других государств (во второй половине XIV - первой половине XVI в."}].each{|category| Category.create(category) }
      [{'category_sign'=>"ancient",'name_ua'=>"Поява людського життя в Україні",'name_ru'=>"Появление человеческой жизни в Украине",'file'=>"7_01",'summary'=>"7_01",'legend'=>"7_Main",'pictures_list'=>"7_01",'questionnaire'=>"7_01"},{'category_sign'=>"ancient",'name_ua'=>"Найдавніші землероби та скотарі на території України",'name_ru'=>"Древнейшие земледельцы и скотоводы на территории Украины",'file'=>"7_02",'summary'=>"7_02",'legend'=>"7_Main",'pictures_list'=>"7_02",'questionnaire'=>"7_02"},{'category_sign'=>"ancient",'name_ua'=>"Доба бронзи і раннього заліза на території України (друга половина ІІІ - початок І тис. до н.е. Світ кочовиків і світ цивілізацій)",'name_ru'=>"Эпоха бронзы и раннего железа на территории Украины (вторая половина III - начало I тыс. до н.э. Мир кочевников и мир цивилизаций)",'file'=>"7_03",'summary'=>"7_03",'legend'=>"7_Main",'pictures_list'=>"7_03",'questionnaire'=>"7_03"},{'category_sign'=>"ancient",'name_ua'=>"Велика Скіфія",'name_ru'=>"Великая Скифия",'file'=>"7_04",'summary'=>"7_03",'legend'=>"7_Main",'pictures_list'=>"7_03",'questionnaire'=>"7_03"},{'category_sign'=>"ancient",'name_ua'=>"Українські землі в ІІІ - І ст. до н.е.",'name_ru'=>"Украинские земли в III - I вв. до н.э.",'file'=>"7_05",'summary'=>"7_03",'legend'=>"7_Main",'pictures_list'=>"7_03",'questionnaire'=>"7_03"},{'category_sign'=>"ancient",'name_ua'=>"Велика Скіфія",'name_ru'=>"Великая Скифия",'file'=>"7_04",'summary'=>"7_04",'legend'=>"7_Main",'pictures_list'=>"7_04",'questionnaire'=>"7_04"},{'category_sign'=>"ancient",'name_ua'=>"Українські землі в ІІІ - І ст. до н.е. Сармати. Велике переселення народів II - IV ст.",'name_ru'=>"Украинские земли в III - I вв. до н.э. Сарматы. Великое переселение народов II - IV вв.",'file'=>"7_07",'summary'=>"7_04",'legend'=>"7_Main",'pictures_list'=>"7_04",'questionnaire'=>"7_04"},{'category_sign'=>"ancient",'name_ua'=>"Українські землі в ІІІ - І ст. до н.е. Сармати. Велике переселення народів II - IV ст.",'name_ru'=>"Украинские земли в III - I вв. до н.э. Сарматы. Великое переселение народов II - IV вв.",'file'=>"7_07",'summary'=>"7_07",'legend'=>"7_Main",'pictures_list'=>"7_0506",'questionnaire'=>"7_0506"},{'category_sign'=>"ancient",'name_ua'=>"Велике розселення слов'ян V - VIII ст.",'name_ru'=>"Великое расселение славян V - VIII вв.",'file'=>"7_09",'summary'=>"7_0506",'legend'=>"7_Main",'pictures_list'=>"7_0506",'questionnaire'=>"7_0506"},{'category_sign'=>"emergence",'name_ua'=>"Східнослов'янські племена - предки українців - напередодні утворення держави",'name_ru'=>"Восточнославянские племена - предки украинского - накануне образования государства",'file'=>"7_09",'summary'=>"7_07",'legend'=>"7_Main",'pictures_list'=>"7_07",'questionnaire'=>"7_07"},{'category_sign'=>"emergence",'name_ua'=>"Київська держава за перших князів",'name_ru'=>"Киевское государство при первых князьях",'file'=>"7_11",'summary'=>"7_08",'legend'=>"7_Main",'pictures_list'=>"7_08",'questionnaire'=>"7_08"},{'category_sign'=>"emergence",'name_ua'=>"Князювання Ольги та Святослава",'name_ru'=>"Времена Ольги и Святослава",'file'=>"7_12",'summary'=>"7_09",'legend'=>"7_Main",'pictures_list'=>"7_09",'questionnaire'=>"7_09"},{'category_sign'=>"emergence",'name_ua'=>"Князь Володимир Великий. Впровадження християнства як державної релігії",'name_ru'=>"Времена князя Владимира Великого. Внедрение христианства как государственной религии",'file'=>"7_13",'summary'=>"7_1011",'legend'=>"7_Main",'pictures_list'=>"7_1011",'questionnaire'=>"7_1011"},{'category_sign'=>"emergence",'name_ua'=>"Князювання Володимира Великого та Ярослава Мудрого",'name_ru'=>"Владимир Великий и Ярослав Мудрый",'file'=>"7_13",'summary'=>"7_12",'legend'=>"7_Main",'pictures_list'=>"7_12",'questionnaire'=>"7_12"},{'category_sign'=>"emergence",'name_ua'=>"Київ у XI-XIII ст.",'name_ru'=>"Киев в XI-XIII вв.",'file'=>"7_15",'summary'=>"7_12",'legend'=>"7_Main",'pictures_list'=>"7_12",'questionnaire'=>"7_12"},{'category_sign'=>"emergence",'name_ua'=>"Правління Ярославичів",'name_ru'=>"Правление Ярославичей",'file'=>"7_16",'summary'=>"7_1314",'legend'=>"7_Main",'pictures_list'=>"7_1314",'questionnaire'=>"7_1314"},{'category_sign'=>"emergence",'name_ua'=>"Володимир Мономах та Мстислав Володимирович",'name_ru'=>"Владимир Мономаха и Мстислав Владимирович",'file'=>"7_17",'summary'=>"7_1314",'legend'=>"7_Main",'pictures_list'=>"7_1314",'questionnaire'=>"7_1314"},{'category_sign'=>"fragmentation",'name_ua'=>"Роздробленість Київської Русі",'name_ru'=>"Раздробленность Киевской Руси",'file'=>"7_18",'summary'=>"7_15",'legend'=>"7_Main",'pictures_list'=>"7_15",'questionnaire'=>"7_15"},{'category_sign'=>"fragmentation",'name_ua'=>"Утворення Галицько-Волинської держави",'name_ru'=>"Образование Галицко-Волынского государства",'file'=>"7_18",'summary'=>"7_16",'legend'=>"7_Main",'pictures_list'=>"7_16",'questionnaire'=>"7_16"},{'category_sign'=>"fragmentation",'name_ua'=>"Монгольська навала на українські землі",'name_ru'=>"Монгольское нашествие на украинские земли",'file'=>"7_20",'summary'=>"7_17",'legend'=>"7_Main",'pictures_list'=>"7_17",'questionnaire'=>"7_17"},{'category_sign'=>"fragmentation",'name_ua'=>"Галицько-Волинська держава за князя Данила Романовича та його наступників",'name_ru'=>"Галицко-Волынское государство за князя Даниила Романовича и его преемников",'file'=>"7_20",'summary'=>"7_18",'legend'=>"7_Main",'pictures_list'=>"7_18",'questionnaire'=>"7_18"},{'category_sign'=>"structure",'name_ua'=>"Політичний, соціальний устрій та господарське життя Київської Русі та Галицько-Волинської держави",'name_ru'=>"Политический, социальный строй и хозяйственную жизнь Киевской Руси и Галицко-Волынского государства",'file'=>"7_22",'summary'=>"7_19",'legend'=>"7_Main",'pictures_list'=>"7_19",'questionnaire'=>"7_19"},{'category_sign'=>"structure",'name_ua'=>"Писемність, освіта, наукові знання, література, театральні дійства і музика Київської Русі та Галицько-Волинської держави",'name_ru'=>"Письменность, образование, научные знания, литература, театральные представления и музыка Киевской Руси и Галицко-Волынского государства",'file'=>"7_22",'summary'=>"7_20",'legend'=>"7_Main",'pictures_list'=>"7_20",'questionnaire'=>"7_20"},{'category_sign'=>"structure",'name_ua'=>"Архітектура й образотворче мистецтво Київської Русі та Галицько-Волинської держави",'name_ru'=>"Архитектура и изобразительное искусство Киевской Руси и Галицко-Волынского государства",'file'=>"7_22",'summary'=>"7_21",'legend'=>"7_Main",'pictures_list'=>"7_21",'questionnaire'=>"7_21"},{'category_sign'=>"structure",'name_ua'=>"Історичне значення Київської Русі та Галицько-Волинської держави",'name_ru'=>"Историческое значение Киевской Руси и Галицко-Волынского государства",'file'=>"7_22",'summary'=>"7_22",'legend'=>"7_Main",'pictures_list'=>"7_22",'questionnaire'=>"7_22"},{'category_sign'=>"litva",'name_ua'=>"Початок литовського та польського володарювання на українських землях",'name_ru'=>"Начало литовского и польского владычества на украинских землях",'file'=>"7_26",'summary'=>"7_23",'legend'=>"7_Main",'pictures_list'=>"7_23",'questionnaire'=>"7_23"},{'category_sign'=>"litva",'name_ua'=>"Українські землі в XIV ст. Володіння литовських князів Ґедиміновичів у другій половині XIV ст.",'name_ru'=>"Украинские земли в XIV в. Знание литовских князей Гедиминовичей во второй половине XIV в.",'file'=>"7_26",'summary'=>"7_24",'legend'=>"7_Main",'pictures_list'=>"7_24",'questionnaire'=>"7_24"},{'category_sign'=>"litva",'name_ua'=>"Українські землі в XV ст.",'name_ru'=>"Украинские земли в XV в.",'file'=>"7_28",'summary'=>"7_24",'legend'=>"7_Main",'pictures_list'=>"7_24",'questionnaire'=>"7_24"},{'category_sign'=>"litva",'name_ua'=>"Українські землі в XIV ст. Володіння литовських князів Ґедиміновичів у другій половині XIV ст.",'name_ru'=>"Украинские земли в XIV в. Знание литовских князей Гедиминовичей во второй половине XIV в.",'file'=>"7_26",'summary'=>"7_25",'legend'=>"7_Main",'pictures_list'=>"7_25",'questionnaire'=>"7_25"},{'category_sign'=>"litva",'name_ua'=>"Українські земліі в XV ст.",'name_ru'=>"Украинские земли и в XV в.",'file'=>"7_28",'summary'=>"7_25",'legend'=>"7_Main",'pictures_list'=>"7_25",'questionnaire'=>"7_25"},{'category_sign'=>"litva",'name_ua'=>"Соціальний устрій та господарське життя в Україні в другій половині XIV - в перший половині XVI ст.",'name_ru'=>"Социальный строй и хозяйственную жизнь в Украине во второй половине XIV - в первой половине XVI в.",'file'=>"7_31",'summary'=>"7_26",'legend'=>"7_Main",'pictures_list'=>"7_26",'questionnaire'=>"7_26"},{'category_sign'=>"litva",'name_ua'=>"Культурне життя в другій половині XIV - в перший половині XVI ст.",'name_ru'=>"Культурная жизнь во второй половине XIV - в первой половине XVI в.",'file'=>"7_31",'summary'=>"7_27",'legend'=>"7_Main",'pictures_list'=>"7_27",'questionnaire'=>"7_27"}].each{|map| Map.create(map) }
    end
    if Bill.find(:all).size == 0
      code = (0...6).map{(65 + rand(26)).chr }.join
      token =  (0...32).map.with_index{|i| ('a'..'z').to_a.concat(('0'..'9').to_a)[rand(36)] }.join
      Bill.create({'code' => code, 'token' => token, 'paid' => 0})
    end
    if Control.find(:all).size == 0
      # PLACEHOLDER: default_lang, e.g. default_lang = 'ru'
      default_lang = 'ua'
      Control.create({'name' => 'lang', 'value' => default_lang, 'type' => 'select', 'values_str' => '["ru","ua"]'})
      Control.create({'name' => 'icon_size', 'value' => (System::get_property('platform') == 'APPLE' ? 'small' : 'normal'), 'type' => 'select', 'values_str' => '["small","normal"]'})
      Control.create({'name' => 'zoom_step', 'value' => '70', 'type' => 'range', 'values_str' => '{"min":50,"max":100,"step":1}'})
      Control.create({'name' => 'show_controls_icon', 'value' => '1', 'type' => 'checkbox'})
    end

    # Tab items are loaded left->right, @tabs[0] is leftmost tab in the tab-bar
    # Super must be called *after* settings @tabs!
    @tabs = nil
    #To remove default toolbar uncomment next line:
    @@toolbar = nil
    super

    # Uncomment to set sync notification callback to /app/Settings/sync_notify.
    # SyncEngine::set_objectnotify_url("/app/Settings/sync_notify")
    SyncEngine.set_notification(-1, "/app/Settings/sync_notify", '')
  end
end
