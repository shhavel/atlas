require 'rho/rhoapplication'

class AppApplication < Rho::RhoApplication
  def initialize
    if Category.find(:all).size == 0 || Map.find(:all).size == 0
      Rhom::Rhom.database_full_reset(false, true)
      # PLACEHOLDER: categories & maps, i.e. categories.each{|category| Category.create(category) }
      [{'sign'=>"discoveries",'name_ua'=>"Великі географічні відкриття",'name_ru'=>"Великие географические открытия"},{'sign'=>"reformation",'name_ua'=>"Початок Реформації в Європі",'name_ru'=>"Начало Реформации в Европе"},{'sign'=>"netherlands",'name_ua'=>"Визвольний рух у Нідерландах",'name_ru'=>"Освободительное движение в Нидерландах"},{'sign'=>"france",'name_ua'=>"Франція у XVI - першій половині XVII ст.",'name_ru'=>"Франция в XVI - первой половине XVII в."},{'sign'=>"england",'name_ua'=>"Англія в XVI ст.",'name_ru'=>"Англия в XVI в."},{'sign'=>"muscovy",'name_ua'=>"Московська держава в XVI – XVII ст.",'name_ru'=>"Московское государство в XVI - XVII вв."},{'sign'=>"30_years_war",'name_ua'=>"Тридцятилітня війна",'name_ru'=>"Тридцатилетняя война"},{'sign'=>"poland",'name_ua'=>"Польща в XVI – XVIІІ ст.",'name_ru'=>"Польша в XVI - XVIII в."},{'sign'=>"orient",'name_ua'=>"Країни Сходу в XVI – XVIІІ ст.",'name_ru'=>"Страны Востока в XVI - XVIII в."},{'sign'=>"english_revolution",'name_ua'=>"Англійська революція середини XVIІ ст.",'name_ru'=>"Английская революция середины XVII в."},{'sign'=>"russian_state",'name_ua'=>"Російська держава наприкінці XVIІ – XVIІІ ст.",'name_ru'=>"Русское государство в конце XVII - XVIII в."},{'sign'=>"german_states",'name_ua'=>"Німецькі держави у XVIІ ст.",'name_ru'=>"Германские государства в XVII в."},{'sign'=>"america",'name_ua'=>"Америка у XVIІІ ст.",'name_ru'=>"Америка в XVIII в."}].each{|category| Category.create(category) }
      [{'category_sign'=>"discoveries",'name_ua'=>"Цивілізації та культури народів світу наприкинці XV ст.",'name_ru'=>"Цивилизации и культуры народов мира наприкинци XV в.",'file'=>"b_1",'summary'=>"b_1",'pictures_list'=>"r_1",'questionnaire'=>"r_1"},{'category_sign'=>"discoveries",'name_ua'=>"Великі географічні відкриття і подорожі кінця XV – першої половини XVII ст. Утворення колоніальних імперій",'name_ru'=>"Великие географические открытия и путешествия конца XV ​​- первой половины XVII в. Образование колониальных империй",'file'=>"b_2",'summary'=>"b_1",'pictures_list'=>"r_1",'questionnaire'=>"r_1"},{'category_sign'=>"discoveries",'name_ua'=>"Англо-іспанська боротьба",'name_ru'=>"Англо-испанская борьба",'file'=>"b_7",'summary'=>"b_1",'pictures_list'=>"r_1",'questionnaire'=>"r_1"},{'category_sign'=>"reformation",'name_ua'=>"Реформація і Контрреформація в Європі",'name_ru'=>"Реформация и Контрреформация в Европе",'file'=>"b_4",'summary'=>"b_2",'pictures_list'=>"r_2",'questionnaire'=>"r_2"},{'category_sign'=>"reformation",'name_ua'=>"Європа в XVI ст.",'name_ru'=>"Европа в XVI в.",'file'=>"b_9",'summary'=>"b_2",'pictures_list'=>"r_2",'questionnaire'=>"r_2"},{'category_sign'=>"netherlands",'name_ua'=>"Нідерланди у XVI – першій половині XVIІ ст. Нідерландська революція 1566-1609 рр.",'name_ru'=>"Нидерланды в XVI - первой половине XVII в. Нидерландская революция 1566-1609 гг",'file'=>"b_6",'summary'=>"b_3",'pictures_list'=>"r_3",'questionnaire'=>"r_3"},{'category_sign'=>"netherlands",'name_ua'=>"Європа в XVI ст.",'name_ru'=>"Европа в XVI в.",'file'=>"b_9",'summary'=>"b_3",'pictures_list'=>"r_3",'questionnaire'=>"r_3"},{'category_sign'=>"france",'name_ua'=>"Франція у XVI – першій половині XVIІ ст.",'name_ru'=>"Франция в XVI - первой половине XVII в.",'file'=>"b_5",'summary'=>"b_4",'pictures_list'=>"r_4",'questionnaire'=>"r_4"},{'category_sign'=>"france",'name_ua'=>"Європа в XVI ст.",'name_ru'=>"Европа в XVI в.",'file'=>"b_9",'summary'=>"b_4",'pictures_list'=>"r_4",'questionnaire'=>"r_4"},{'category_sign'=>"france",'name_ua'=>"Європа у другій половині XVIІ – першій третині XVIІІ ст.",'name_ru'=>"Европа во второй половине XVII - первой трети XVIII в.",'file'=>"b_17",'summary'=>"b_4",'pictures_list'=>"r_4",'questionnaire'=>"r_4"},{'category_sign'=>"england",'name_ua'=>"Англія у XVI – першій половині XVIІ ст.",'name_ru'=>"Англия в XVI - первой половине XVII в.",'file'=>"b_6",'summary'=>"b_5",'pictures_list'=>"r_5",'questionnaire'=>"r_5"},{'category_sign'=>"england",'name_ua'=>"Англо-іспанська боротьба XVI – XVII ст. Колоніальна торгівля в Атлантиці",'name_ru'=>"Англо-испанский борьба XVI - XVII вв. Колониальная торговля в Атлантике",'file'=>"b_7",'summary'=>"b_5",'pictures_list'=>"r_5",'questionnaire'=>"r_5"},{'category_sign'=>"muscovy",'name_ua'=>"Московське царство в XVI ст.",'name_ru'=>"Московское царство в XVI в.",'file'=>"b_8",'summary'=>"b_6",'pictures_list'=>"r_6",'questionnaire'=>"r_6"},{'category_sign'=>"muscovy",'name_ua'=>"Московське царство в XVIІ ст.",'name_ru'=>"Московское царство в XVII в.",'file'=>"b_12",'summary'=>"b_6",'pictures_list'=>"r_6",'questionnaire'=>"r_6"},{'category_sign'=>"30_years_war",'name_ua'=>"Тридцятилітня війна 1618-1648 рр. Угруповання держав у війні. Битва під Лютценом 16 листопада 1632 р.",'name_ru'=>"Тридцатилетняя война 1618-1648 гг Группировка государств в войне. Битва при Лютцене 16 ноября 1632",'file'=>"b_10",'summary'=>"b_7",'pictures_list'=>"r_7",'questionnaire'=>"r_7"},{'category_sign'=>"30_years_war",'name_ua'=>"Європа в середині XVIІ ст. Спустошення імперських земель унаслідок Тридцятилітньої війни",'name_ru'=>"Европа в середине XVII в. Опустошение имперских земель вследствие Тридцатилетней войны",'file'=>"b_11",'summary'=>"b_7",'pictures_list'=>"r_7",'questionnaire'=>"r_7"},{'category_sign'=>"poland",'name_ua'=>"Польща у XVI – XVIІ ст.",'name_ru'=>"Польша в XVI - XVII вв.",'file'=>"b_13",'summary'=>"b_8",'pictures_list'=>"r_8",'questionnaire'=>"r_8"},{'category_sign'=>"orient",'name_ua'=>"Османська імперія в XVI – XVIІ ст. Битва під Лепанто 7 жовтня 1571 р.",'name_ru'=>"Османская империя в XVI - XVII вв. Битва при Лепанто 7 октября 1571",'file'=>"b_14",'summary'=>"b_9",'pictures_list'=>"r_9",'questionnaire'=>"r_9"},{'category_sign'=>"orient",'name_ua'=>"Країни Азії в XVI – XVIІ ст.",'name_ru'=>"Страны Азии в XVI - XVII вв.",'file'=>"b_15",'summary'=>"b_9",'pictures_list'=>"r_9",'questionnaire'=>"r_9"},{'category_sign'=>"orient",'name_ua'=>"Країни Азії у XVIІІ ст.",'name_ru'=>"Страны Азии в XVIII в.",'file'=>"b_23",'summary'=>"b_9",'pictures_list'=>"r_9",'questionnaire'=>"r_9"},{'category_sign'=>"english_revolution",'name_ua'=>"Англійська революція 1640-1660 рр. Початок промислового перевороту в Англії. Утворення Великої Британії",'name_ru'=>"Английская революция 1640-1660 гг Начало промышленного переворота в Англии. Образование Великобритании",'file'=>"b_16",'summary'=>"b_10",'pictures_list'=>"r_10",'questionnaire'=>"r_10"},{'category_sign'=>"russian_state",'name_ua'=>"Росія наприкінці XVII – в першій половині XVIII ст. Полтавська битва 27 червня 1709 р.",'name_ru'=>"Россия в конце XVII - первой половине XVIII в. Полтавская битва 27 июня 1709",'file'=>"b_18",'summary'=>"b_11",'pictures_list'=>"r_11",'questionnaire'=>"r_11"},{'category_sign'=>"russian_state",'name_ua'=>"Європа в другій половині XVIІ – першій третині XVIІІ ст.",'name_ru'=>"Европа во второй половине XVII - первой трети XVIII в.",'file'=>"b_17",'summary'=>"b_11",'pictures_list'=>"r_11",'questionnaire'=>"r_11"},{'category_sign'=>"russian_state",'name_ua'=>"Російська імперія в другій половині XVIІІ ст. Зростання території Російської держави у XVI – XVIІІ ст.",'name_ru'=>"Российская империя во второй половине XVIII в. Рост территории Российского государства в XVI - XVIII в.",'file'=>"b_21",'summary'=>"b_11",'pictures_list'=>"r_11",'questionnaire'=>"r_11"},{'category_sign'=>"russian_state",'name_ua'=>"Європа у другій половині XVIІІ ст.",'name_ru'=>"Европа во второй половине XVIII в.",'file'=>"b_24",'summary'=>"b_11",'pictures_list'=>"r_11",'questionnaire'=>"r_11"},{'category_sign'=>"german_states",'name_ua'=>"Австрійська монархія Габсбурґів і Брандебурзько-Прусcька держава в XVI – XVIІІ ст.",'name_ru'=>"Австрийская монархия Габсбургов и Брандебурзько-прусской государство в XVI - XVIII в.",'file'=>"b_19",'summary'=>"b_12",'pictures_list'=>"r_12",'questionnaire'=>"r_12"},{'category_sign'=>"german_states",'name_ua'=>"Європа в другій половині XVIІ – першій третині XVIІІ ст.",'name_ru'=>"Европа во второй половине XVII - первой трети XVIII в.",'file'=>"b_17",'summary'=>"b_12",'pictures_list'=>"r_12",'questionnaire'=>"r_12"},{'category_sign'=>"german_states",'name_ua'=>"Семилітня війна 1756-1763 рр. Світ після Семилітньої війни",'name_ru'=>"Семилетняя война 1756-1763 гг Мир после Семилетней войны",'file'=>"b_20",'summary'=>"b_12",'pictures_list'=>"r_12",'questionnaire'=>"r_12"},{'category_sign'=>"america",'name_ua'=>"Північна Америка у XVIІІ ст. Війна за незалежність англійських колоній в Америці. Утворення Сполучених Штатів Америки",'name_ru'=>"Северная Америка в XVIII в. Война за независимость английских колоний в Америке. Образование США",'file'=>"b_22",'summary'=>"b_13",'pictures_list'=>"r_13",'questionnaire'=>"r_13"}].each{|map| Map.create(map) }
    end
    if Bill.find(:all).size == 0
      code = (0...6).map{(65 + rand(26)).chr }.join
      token =  (0...32).map.with_index{|i| ('a'..'z').to_a.concat(('0'..'9').to_a)[rand(36)] }.join
      Bill.create({'code' => code, 'token' => token, 'paid' => 0})
    end
    if Control.find(:all).size == 0
      # PLACEHOLDER: default_lang, e.g. default_lang = 'ru'
      default_lang = 'ua'
      Control.create({'name' => 'lang', 'value' => default_lang, 'type' => 'select', 'values_str' => '["ru","ua"]'})
      Control.create({'name' => 'icon_size', 'value' => (System::get_property('platform') == 'APPLE' ? 'small' : 'normal'), 'type' => 'select', 'values_str' => '["small","normal"]'})
      Control.create({'name' => 'zoom_step', 'value' => '70', 'type' => 'range', 'values_str' => '{"min":50,"max":100,"step":1}'})
      Control.create({'name' => 'show_controls_icon', 'value' => '1', 'type' => 'checkbox'})
    end

    # Tab items are loaded left->right, @tabs[0] is leftmost tab in the tab-bar
    # Super must be called *after* settings @tabs!
    @tabs = nil
    #To remove default toolbar uncomment next line:
    @@toolbar = nil
    super

    # Uncomment to set sync notification callback to /app/Settings/sync_notify.
    # SyncEngine::set_objectnotify_url("/app/Settings/sync_notify")
    SyncEngine.set_notification(-1, "/app/Settings/sync_notify", '')
  end
end
